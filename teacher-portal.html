<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Portal - King Solomon Junior School</title>
    
    <!-- Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
    <link rel="stylesheet" href="css/modern-enhancements.css">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --secondary: #a78bfa;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-dark: #1e293b;
            --text-gray: #64748b;
            --border: #e2e8f0;
            --sidebar-width: 280px;
        }

        body.dark-mode {
            --bg-light: #0f172a;
            --bg-white: #1e293b;
            --text-dark: #f1f5f9;
            --text-gray: #cbd5e1;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-light);
            color: var(--text-dark);
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: var(--sidebar-width);
            height: 100vh;
            background: linear-gradient(180deg, var(--primary), var(--secondary));
            color: white;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            box-shadow: 4px 0 20px rgba(0,0,0,0.1);
        }

        .sidebar-header {
            padding: 25px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .school-logo {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .school-info h1 {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .school-info p {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .sidebar-nav {
            flex: 1;
            overflow-y: auto;
            padding: 20px 0;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 5px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            cursor: pointer;
        }

        .nav-link:hover {
            background: rgba(255,255,255,0.1);
            border-left-color: white;
        }

        .nav-item.active .nav-link {
            background: rgba(255,255,255,0.2);
            border-left-color: white;
        }

        .nav-link i {
            width: 24px;
            margin-right: 15px;
        }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            cursor: pointer;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            min-height: 100vh;
        }

        .top-bar {
            background: var(--bg-white);
            padding: 20px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .page-title {
            font-size: 1.8rem;
            font-weight: 700;
        }

        .content-area {
            padding: 30px;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: all 0.3s ease;
        }

        body.dark-mode .stat-card {
            background: var(--bg-white);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }

        .stat-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            color: var(--text-gray);
            font-size: 0.95rem;
        }

        /* Widget */
        .widget {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-bottom: 25px;
        }

        body.dark-mode .widget {
            background: var(--bg-white);
        }

        .widget-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border);
        }

        .widget-title {
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Class Cards */
        .class-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .class-card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 5px solid var(--primary);
        }

        body.dark-mode .class-card {
            background: var(--bg-white);
        }

        .class-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .class-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }

        .class-name {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .student-count {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* Modern Table */
        .modern-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 10px;
        }

        .modern-table thead th {
            background: var(--bg-light);
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--text-gray);
            font-size: 0.85rem;
            text-transform: uppercase;
        }

        .modern-table tbody tr {
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        body.dark-mode .modern-table tbody tr {
            background: var(--bg-white);
        }

        .modern-table tbody tr:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .modern-table tbody td {
            padding: 15px;
            border: none;
        }

        .modern-table tbody tr td:first-child {
            border-radius: 8px 0 0 8px;
        }

        .modern-table tbody tr td:last-child {
            border-radius: 0 8px 8px 0;
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        body.dark-mode .chart-card {
            background: var(--bg-white);
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-canvas {
            height: 300px;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .quick-action {
            background: white;
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        body.dark-mode .quick-action {
            background: var(--bg-white);
        }

        .quick-action:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.2);
        }

        .quick-action i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 15px;
            display: block;
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.active {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
            .stats-grid, .charts-grid, .class-grid, .quick-actions {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Mobile Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleSidebar()" style="display: none; position: fixed; top: 20px; left: 20px; z-index: 1001; background: var(--primary); color: white; border: none; width: 45px; height: 45px; border-radius: 50%; cursor: pointer;">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo-section">
                <div class="school-logo">👩‍🏫</div>
                <div class="school-info">
                    <h1>KS Junior</h1>
                    <p>Teacher Portal</p>
                </div>
            </div>
        </div>

        <nav class="sidebar-nav">
            <ul class="nav-menu">
                <li class="nav-item active" data-section="dashboard">
                    <a class="nav-link">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item" data-section="classes">
                    <a class="nav-link">
                        <i class="fas fa-users"></i>
                        <span>My Classes</span>
                    </a>
                </li>
                <li class="nav-item" data-section="students">
                    <a class="nav-link">
                        <i class="fas fa-user-graduate"></i>
                        <span>Students</span>
                    </a>
                </li>
                <li class="nav-item" data-section="attendance">
                    <a class="nav-link">
                        <i class="fas fa-calendar-check"></i>
                        <span>Attendance</span>
                    </a>
                </li>
                <li class="nav-item" data-section="assignments">
                    <a class="nav-link">
                        <i class="fas fa-tasks"></i>
                        <span>Assignments</span>
                    </a>
                </li>
                <li class="nav-item" data-section="grading">
                    <a class="nav-link">
                        <i class="fas fa-clipboard-check"></i>
                        <span>Grading</span>
                    </a>
                </li>
                <li class="nav-item" data-section="timetable">
                    <a class="nav-link">
                        <i class="fas fa-clock"></i>
                        <span>My Schedule</span>
                    </a>
                </li>
                <li class="nav-item" data-section="messages">
                    <a class="nav-link">
                        <i class="fas fa-envelope"></i>
                        <span>Messages</span>
                    </a>
                </li>
                <li class="nav-item" data-section="profile">
                    <a class="nav-link">
                        <i class="fas fa-user"></i>
                        <span>Profile</span>
                    </a>
                </li>
            </ul>
        </nav>

        <div class="sidebar-footer">
            <div class="user-info" onclick="showUserMenu()">
                <div class="user-avatar">MJ</div>
                <div class="user-details">
                    <h4>Mrs. Johnson</h4>
                    <p>Mathematics Teacher</p>
                </div>
                <i class="fas fa-chevron-up" style="margin-left: auto;"></i>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Top Bar -->
        <div class="top-bar">
            <h1 class="page-title" id="pageTitle">Dashboard</h1>
            <div style="display: flex; gap: 15px; align-items: center;">
                <button class="notification-btn" onclick="showNotifications()" style="position: relative; background: var(--bg-light); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer;">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" style="position: absolute; top: -5px; right: -5px; background: #dc2626; color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 0.7rem; display: flex; align-items: center; justify-content: center;">4</span>
                </button>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Dashboard Section -->
            <div class="content-section active" id="dashboard-section">
                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card" data-aos="zoom-in">
                        <div class="stat-icon">👥</div>
                        <div>
                            <div class="stat-value">85</div>
                            <div class="stat-label">Total Students</div>
                            <small style="color: var(--text-gray); margin-top: 5px; display: block;">Across 3 classes</small>
                        </div>
                    </div>

                    <div class="stat-card" data-aos="zoom-in" data-aos-delay="100">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #059669, #047857);">📝</div>
                        <div>
                            <div class="stat-value">12</div>
                            <div class="stat-label">Pending Grades</div>
                            <small style="color: var(--text-gray); margin-top: 5px; display: block;">To be graded</small>
                        </div>
                    </div>

                    <div class="stat-card" data-aos="zoom-in" data-aos-delay="200">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #0891b2, #0e7490);">✅</div>
                        <div>
                            <div class="stat-value">96%</div>
                            <div class="stat-label">Avg Attendance</div>
                            <small style="color: var(--text-gray); margin-top: 5px; display: block;">This month</small>
                        </div>
                    </div>

                    <div class="stat-card" data-aos="zoom-in" data-aos-delay="300">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">📊</div>
                        <div>
                            <div class="stat-value">B+</div>
                            <div class="stat-label">Class Average</div>
                            <small style="color: var(--text-gray); margin-top: 5px; display: block;">Overall performance</small>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions" data-aos="fade-up">
                    <div class="quick-action" onclick="quickMarkAttendance()">
                        <i class="fas fa-check-square"></i>
                        <strong style="display: block;">Mark Attendance</strong>
                        <small style="color: var(--text-gray);">Quick attendance</small>
                    </div>
                    <div class="quick-action" onclick="quickCreateAssignment()">
                        <i class="fas fa-plus-circle"></i>
                        <strong style="display: block;">Create Assignment</strong>
                        <small style="color: var(--text-gray);">New assignment</small>
                    </div>
                    <div class="quick-action" onclick="quickGradeWork()">
                        <i class="fas fa-pen-square"></i>
                        <strong style="display: block;">Grade Work</strong>
                        <small style="color: var(--text-gray);">12 pending</small>
                    </div>
                    <div class="quick-action" onclick="quickMessageParents()">
                        <i class="fas fa-paper-plane"></i>
                        <strong style="display: block;">Message Parents</strong>
                        <small style="color: var(--text-gray);">Send message</small>
                    </div>
                </div>

                <!-- Charts -->
                <div class="charts-grid">
                    <div class="chart-card" data-aos="fade-up">
                        <h3 class="chart-title">
                            <i class="fas fa-chart-line"></i>
                            Class Performance Trend
                        </h3>
                        <div class="chart-canvas">
                            <canvas id="performanceTrendChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card" data-aos="fade-up" data-aos-delay="100">
                        <h3 class="chart-title">
                            <i class="fas fa-chart-pie"></i>
                            Grade Distribution
                        </h3>
                        <div class="chart-canvas">
                            <canvas id="gradeDistributionChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card" data-aos="fade-up" data-aos-delay="200">
                        <h3 class="chart-title">
                            <i class="fas fa-chart-bar"></i>
                            Subject Performance
                        </h3>
                        <div class="chart-canvas">
                            <canvas id="subjectPerformanceChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card" data-aos="fade-up" data-aos-delay="300">
                        <h3 class="chart-title">
                            <i class="fas fa-calendar-check"></i>
                            Attendance Overview
                        </h3>
                        <div class="chart-canvas">
                            <canvas id="attendanceOverviewChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- My Classes Overview -->
                <div class="widget" data-aos="fade-up">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-chalkboard"></i>
                            My Classes
                        </h3>
                    </div>
                    <div class="class-grid">
                        <div class="class-card" onclick="viewClass(1)">
                            <div class="class-header">
                                <div>
                                    <div class="class-name">STD 8 - Stream A</div>
                                    <small style="color: var(--text-gray);">Mathematics</small>
                                </div>
                                <div class="student-count">28 Students</div>
                            </div>
                            <div style="display: flex; gap: 20px; margin-top: 15px;">
                                <div>
                                    <div style="color: var(--text-gray); font-size: 0.85rem;">Avg Grade</div>
                                    <strong style="color: var(--primary);">A-</strong>
                                </div>
                                <div>
                                    <div style="color: var(--text-gray); font-size: 0.85rem;">Attendance</div>
                                    <strong style="color: #059669;">98%</strong>
                                </div>
                                <div>
                                    <div style="color: var(--text-gray); font-size: 0.85rem;">Assignments</div>
                                    <strong style="color: #f59e0b;">5 Active</strong>
                                </div>
                            </div>
                        </div>

                        <div class="class-card" onclick="viewClass(2)" style="border-left-color: #059669;">
                            <div class="class-header">
                                <div>
                                    <div class="class-name">STD 7 - Stream B</div>
                                    <small style="color: var(--text-gray);">Mathematics</small>
                                </div>
                                <div class="student-count" style="background: linear-gradient(135deg, #059669, #047857);">30 Students</div>
                            </div>
                            <div style="display: flex; gap: 20px; margin-top: 15px;">
                                <div>
                                    <div style="color: var(--text-gray); font-size: 0.85rem;">Avg Grade</div>
                                    <strong style="color: #059669;">B+</strong>
                                </div>
                                <div>
                                    <div style="color: var(--text-gray); font-size: 0.85rem;">Attendance</div>
                                    <strong style="color: #059669;">94%</strong>
                                </div>
                                <div>
                                    <div style="color: var(--text-gray); font-size: 0.85rem;">Assignments</div>
                                    <strong style="color: #f59e0b;">3 Active</strong>
                                </div>
                            </div>
                        </div>

                        <div class="class-card" onclick="viewClass(3)" style="border-left-color: #0891b2;">
                            <div class="class-header">
                                <div>
                                    <div class="class-name">STD 6 - Stream B</div>
                                    <small style="color: var(--text-gray);">Science</small>
                                </div>
                                <div class="student-count" style="background: linear-gradient(135deg, #0891b2, #0e7490);">27 Students</div>
                            </div>
                            <div style="display: flex; gap: 20px; margin-top: 15px;">
                                <div>
                                    <div style="color: var(--text-gray); font-size: 0.85rem;">Avg Grade</div>
                                    <strong style="color: #0891b2;">A-</strong>
                                </div>
                                <div>
                                    <div style="color: var(--text-gray); font-size: 0.85rem;">Attendance</div>
                                    <strong style="color: #059669;">95%</strong>
                                </div>
                                <div>
                                    <div style="color: var(--text-gray); font-size: 0.85rem;">Assignments</div>
                                    <strong style="color: #f59e0b;">2 Active</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Students Section -->
            <div class="content-section" id="students-section">
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-user-graduate"></i>
                            My Students
                        </h3>
                        <div style="display: flex; gap: 10px;">
                            <select style="padding: 10px; border-radius: 8px; border: 1px solid var(--border);" onchange="filterStudents(this.value)">
                                <option>All Classes</option>
                                <option>STD 8 - Stream A</option>
                                <option>STD 7 - Stream B</option>
                                <option>STD 6 - Stream B</option>
                            </select>
                        </div>
                    </div>
                    <table class="modern-table">
                        <thead>
                            <tr>
                                <th>Student Name</th>
                                <th>Class</th>
                                <th>Avg Grade</th>
                                <th>Attendance</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="studentsTableBody">
                            <tr>
                                <td><strong>John Smith</strong></td>
                                <td>STD 8 - Stream A</td>
                                <td><span class="badge-modern badge-success">A- (92%)</span></td>
                                <td><span class="badge-modern badge-success">98%</span></td>
                                <td>
                                    <button class="btn-enhanced" style="background: var(--primary); color: white; padding: 8px 16px;" onclick="viewStudentDetails('John Smith')">
                                        <i class="fas fa-eye"></i> View
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Sarah Smith</strong></td>
                                <td>STD 6 - Stream B</td>
                                <td><span class="badge-modern badge-success">A (95%)</span></td>
                                <td><span class="badge-modern badge-warning">95%</span></td>
                                <td>
                                    <button class="btn-enhanced" style="background: var(--primary); color: white; padding: 8px 16px;" onclick="viewStudentDetails('Sarah Smith')">
                                        <i class="fas fa-eye"></i> View
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Victor Sam</strong></td>
                                <td>STD 8 - Stream A</td>
                                <td><span class="badge-modern badge-success">A- (88%)</span></td>
                                <td><span class="badge-modern badge-success">100%</span></td>
                                <td>
                                    <button class="btn-enhanced" style="background: var(--primary); color: white; padding: 8px 16px;" onclick="viewStudentDetails('Victor Sam')">
                                        <i class="fas fa-eye"></i> View
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Attendance Section -->
            <div class="content-section" id="attendance-section">
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-calendar-check"></i>
                            Mark Attendance
                        </h3>
                        <div style="display: flex; gap: 10px;">
                            <select id="attendanceClass" style="padding: 10px; border-radius: 8px; border: 1px solid var(--border);">
                                <option>STD 8 - Stream A (28 students)</option>
                                <option>STD 7 - Stream B (30 students)</option>
                                <option>STD 6 - Stream B (27 students)</option>
                            </select>
                            <input type="date" id="attendanceDate" style="padding: 10px; border-radius: 8px; border: 1px solid var(--border);" value="2025-10-04">
                            <button class="btn-enhanced" style="background: #059669; color: white;" onclick="markAllPresent()">
                                <i class="fas fa-check-double"></i> Mark All Present
                            </button>
                        </div>
                    </div>
                    <table class="modern-table">
                        <thead>
                            <tr>
                                <th>Student Name</th>
                                <th>Status</th>
                                <th>Remarks</th>
                            </tr>
                        </thead>
                        <tbody id="attendanceTableBody">
                            <!-- Will be populated -->
                        </tbody>
                    </table>
                    <button class="btn-enhanced" style="background: var(--primary); color: white; margin-top: 20px;" onclick="submitAttendance()">
                        <i class="fas fa-save"></i> Submit Attendance
                    </button>
                </div>
            </div>

            <!-- Assignments Section -->
            <div class="content-section" id="assignments-section">
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-tasks"></i>
                            My Assignments
                        </h3>
                        <button class="btn-enhanced" style="background: var(--primary); color: white;" onclick="createNewAssignment()">
                            <i class="fas fa-plus"></i> Create New Assignment
                        </button>
                    </div>
                    
                    <div style="display: flex; flex-direction: column; gap: 20px;">
                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); border-left: 4px solid #f59e0b;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                                <div>
                                    <strong style="font-size: 1.2rem;">Chapter 5 Exercises</strong>
                                    <p style="color: var(--text-gray); margin: 5px 0;">STD 8 - Stream A | Mathematics</p>
                                    <small style="color: var(--text-gray);">Due: Oct 5, 2025 8:00 AM</small>
                                </div>
                                <span class="badge-modern badge-warning">
                                    <i class="fas fa-clock"></i> 1 day left
                                </span>
                            </div>
                            <div style="display: flex; gap: 15px; align-items: center;">
                                <div style="flex: 1;">
                                    <small style="color: var(--text-gray);">Submissions: 15/28</small>
                                    <div class="progress-container" style="margin-top: 8px;">
                                        <div class="progress-bar-animated" style="width: 0%; background: linear-gradient(90deg, #f59e0b, #d97706);" data-target="54"></div>
                                    </div>
                                </div>
                                <button class="btn-enhanced" style="background: var(--primary); color: white;" onclick="viewSubmissions(1)">
                                    <i class="fas fa-eye"></i> View Submissions
                                </button>
                            </div>
                        </div>

                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); border-left: 4px solid #059669;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                                <div>
                                    <strong style="font-size: 1.2rem;">Plant Growth Project</strong>
                                    <p style="color: var(--text-gray); margin: 5px 0;">STD 6 - Stream B | Science</p>
                                    <small style="color: var(--text-gray);">Due: Oct 3, 2025</small>
                                </div>
                                <span class="badge-modern badge-success">
                                    <i class="fas fa-check"></i> Completed
                                </span>
                            </div>
                            <div style="display: flex; gap: 15px; align-items: center;">
                                <div style="flex: 1;">
                                    <small style="color: var(--text-gray);">Graded: 27/27</small>
                                    <div class="progress-container" style="margin-top: 8px;">
                                        <div class="progress-bar-animated" style="width: 0%; background: linear-gradient(90deg, #059669, #047857);" data-target="100"></div>
                                    </div>
                                </div>
                                <button class="btn-enhanced" style="background: #059669; color: white;" onclick="viewGrades(2)">
                                    <i class="fas fa-chart-bar"></i> View Grades
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Grading Section -->
            <div class="content-section" id="grading-section">
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-clipboard-check"></i>
                            Pending Grading
                        </h3>
                    </div>
                    
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong style="font-size: 1.1rem;">John Smith - Chapter 5 Exercises</strong>
                                    <p style="color: var(--text-gray); margin: 5px 0;">STD 8 - Stream A | Submitted: Oct 3, 2025</p>
                                </div>
                                <button class="btn-enhanced" style="background: var(--primary); color: white;" onclick="gradeSubmission('John Smith', 1)">
                                    <i class="fas fa-pen"></i> Grade Now
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Timetable Section -->
            <div class="content-section" id="timetable-section">
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-clock"></i>
                            My Teaching Schedule
                        </h3>
                    </div>
                    <div id="teacherCalendar"></div>
                </div>
            </div>

            <!-- Messages Section -->
            <div class="content-section" id="messages-section">
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-envelope"></i>
                            Messages
                        </h3>
                        <button class="btn-enhanced" style="background: var(--primary); color: white;" onclick="composeMessage()">
                            <i class="fas fa-pen"></i> New Message
                        </button>
                    </div>
                    
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); cursor: pointer;" onclick="viewMessage(1)">
                            <div style="display: flex; gap: 15px; align-items: start;">
                                <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #10b981, #14b8a6); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">
                                    PS
                                </div>
                                <div style="flex: 1;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <strong>Parent of John Smith</strong>
                                        <span style="color: var(--text-gray); font-size: 0.85rem;">1 day ago</span>
                                    </div>
                                    <p style="color: var(--text-gray); margin: 5px 0;">Question about upcoming mathematics exam...</p>
                                </div>
                                <span class="notification-badge" style="position: static;">New</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="content-section" id="profile-section">
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-user"></i>
                            My Profile
                        </h3>
                        <button class="btn-enhanced" style="background: var(--primary); color: white;" onclick="editProfile()">
                            <i class="fas fa-edit"></i> Edit Profile
                        </button>
                    </div>
                    
                    <div style="display: flex; gap: 30px; align-items: start;">
                        <div style="width: 150px; height: 150px; background: linear-gradient(135deg, var(--primary), var(--secondary)); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 4rem; font-weight: 700;">
                            MJ
                        </div>
                        
                        <div style="flex: 1;">
                            <h2 style="margin-bottom: 20px;">Mrs. Mary Johnson</h2>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                <div>
                                    <label style="font-weight: 600; color: var(--text-gray); font-size: 0.85rem; display: block; margin-bottom: 5px;">EMPLOYEE ID</label>
                                    <p style="font-size: 1.1rem;">TCH2025001</p>
                                </div>
                                <div>
                                    <label style="font-weight: 600; color: var(--text-gray); font-size: 0.85rem; display: block; margin-bottom: 5px;">SUBJECT</label>
                                    <p style="font-size: 1.1rem;">Mathematics</p>
                                </div>
                                <div>
                                    <label style="font-weight: 600; color: var(--text-gray); font-size: 0.85rem; display: block; margin-bottom: 5px;">EMAIL</label>
                                    <p style="font-size: 1.1rem;">m.johnson@ks.ac.ke</p>
                                </div>
                                <div>
                                    <label style="font-weight: 600; color: var(--text-gray); font-size: 0.85rem; display: block; margin-bottom: 5px;">PHONE</label>
                                    <p style="font-size: 1.1rem;">+254 700 111 222</p>
                                </div>
                                <div>
                                    <label style="font-weight: 600; color: var(--text-gray); font-size: 0.85rem; display: block; margin-bottom: 5px;">CLASSES TAUGHT</label>
                                    <p style="font-size: 1.1rem;">3 Classes | 85 Students</p>
                                </div>
                                <div>
                                    <label style="font-weight: 600; color: var(--text-gray); font-size: 0.85rem; display: block; margin-bottom: 5px;">JOINED</label>
                                    <p style="font-size: 1.1rem;">January 2020</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Classes Section -->
            <div class="content-section" id="classes-section">
                <div class="class-grid">
                    <div class="class-card" data-aos="fade-up" onclick="manageClass(1)">
                        <div class="class-header">
                            <div>
                                <div class="class-name">STD 8 - Stream A</div>
                                <small style="color: var(--text-gray);">Mathematics | 28 Students</small>
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <button class="btn-enhanced" style="background: var(--primary); color: white; width: 100%; justify-content: center;">
                                <i class="fas fa-cog"></i> Manage Class
                            </button>
                        </div>
                    </div>

                    <div class="class-card" data-aos="fade-up" data-aos-delay="100" onclick="manageClass(2)" style="border-left-color: #059669;">
                        <div class="class-header">
                            <div>
                                <div class="class-name">STD 7 - Stream B</div>
                                <small style="color: var(--text-gray);">Mathematics | 30 Students</small>
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <button class="btn-enhanced" style="background: #059669; color: white; width: 100%; justify-content: center;">
                                <i class="fas fa-cog"></i> Manage Class
                            </button>
                        </div>
                    </div>

                    <div class="class-card" data-aos="fade-up" data-aos-delay="200" onclick="manageClass(3)" style="border-left-color: #0891b2;">
                        <div class="class-header">
                            <div>
                                <div class="class-name">STD 6 - Stream B</div>
                                <small style="color: var(--text-gray);">Science | 27 Students</small>
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <button class="btn-enhanced" style="background: #0891b2; color: white; width: 100%; justify-content: center;">
                                <i class="fas fa-cog"></i> Manage Class
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/modern-enhancements.js"></script>

    <script>
        // Static Teacher Portal (No Backend Required)
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize teacher portal with demo data
            initializeTeacherPortal();
        });

        function initializeTeacherPortal() {
            // Load dashboard data
            loadDashboardData();
            
            // Setup navigation
            setupNavigation();
            
            // Setup user dropdown
            setupUserDropdown();
        }

        function loadDashboardData() {
            // Load demo data (no backend required)
            const demoClasses = [
                { id: 1, name: 'Grade 5A Mathematics', subject: 'Mathematics', students_count: 25, schedule: 'Mon-Fri 8:00-9:00' },
                { id: 2, name: 'Grade 3B English', subject: 'English', students_count: 20, schedule: 'Mon-Fri 9:00-10:00' }
            ];
            
            const demoStudents = [
                { id: 1, name: 'John Doe', class: 'Grade 5A', admission_number: 'STU001', attendance: 95 },
                { id: 2, name: 'Jane Smith', class: 'Grade 3B', admission_number: 'STU002', attendance: 88 },
                { id: 3, name: 'Mike Johnson', class: 'Grade 5A', admission_number: 'STU003', attendance: 92 }
            ];
            
            const demoAttendance = {
                present: 45,
                absent: 3,
                total: 48,
                percentage: 94
            };
            
            const demoAssignments = [
                { id: 1, title: 'Math Homework', subject: 'Mathematics', due_date: '2024-01-15', status: 'active' },
                { id: 2, title: 'English Essay', subject: 'English', due_date: '2024-01-18', status: 'active' }
            ];

            updateClassesTable(demoClasses);
            updateStudentsTable(demoStudents);
            updateAttendanceStats(demoAttendance);
            updateAssignmentsTable(demoAssignments);
        }

        function updateClassesTable(classes) {
            const tbody = document.querySelector('#classes-section tbody');
            if (!tbody) return;

            tbody.innerHTML = classes.map(cls => `
                <tr>
                    <td><strong>${cls.class_name}</strong><br><small>${cls.subject}</small></td>
                    <td>${cls.student_count || 0}</td>
                    <td>${cls.schedule || 'N/A'}</td>
                    <td>
                        <button class="btn-sm" onclick="viewClass('${cls.id}')" style="background: #3b82f6; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem;">
                            <i class="fas fa-eye"></i> View
                        </button>
                        <button class="btn-sm" onclick="manageClass('${cls.id}')" style="background: #059669; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem;">
                            <i class="fas fa-cog"></i> Manage
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function updateStudentsTable(students) {
            const tbody = document.querySelector('#students-section tbody');
            if (!tbody) return;

            tbody.innerHTML = students.map(student => `
                <tr>
                    <td><strong>${student.first_name} ${student.last_name}</strong><br><small>${student.admission_number}</small></td>
                    <td>${student.class_name || 'N/A'}</td>
                    <td>${student.attendance_percentage || 0}%</td>
                    <td>${student.grade || 'N/A'}</td>
                    <td>
                        <button class="btn-sm" onclick="viewStudent('${student.id}')" style="background: #3b82f6; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem;">
                            <i class="fas fa-eye"></i> View
                        </button>
                        <button class="btn-sm" onclick="markAttendance('${student.id}')" style="background: #059669; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem;">
                            <i class="fas fa-check"></i> Attendance
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function updateAttendanceStats(stats) {
            // Update attendance stats cards
            const statCards = document.querySelectorAll('.stat-card');
            if (statCards.length >= 4) {
                statCards[0].querySelector('.stat-value').textContent = stats.totalStudents || '0';
                statCards[1].querySelector('.stat-value').textContent = stats.presentToday || '0';
                statCards[2].querySelector('.stat-value').textContent = stats.absentToday || '0';
                statCards[3].querySelector('.stat-value').textContent = stats.attendanceRate || '0%';
            }
        }

        function updateAssignmentsTable(assignments) {
            const tbody = document.querySelector('#assignments-section tbody');
            if (!tbody) return;

            tbody.innerHTML = assignments.map(assignment => `
                <tr>
                    <td><strong>${assignment.title}</strong><br><small>${assignment.subject}</small></td>
                    <td>${assignment.class_name || 'N/A'}</td>
                    <td>${assignment.due_date || 'N/A'}</td>
                    <td>${assignment.submissions || 0}/${assignment.total_students || 0}</td>
                    <td>
                        <button class="btn-sm" onclick="viewAssignment('${assignment.id}')" style="background: #3b82f6; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem;">
                            <i class="fas fa-eye"></i> View
                        </button>
                        <button class="btn-sm" onclick="gradeAssignment('${assignment.id}')" style="background: #059669; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem;">
                            <i class="fas fa-edit"></i> Grade
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function setupUserDropdown() {
            const user = window.authService.getCurrentUser();
            if (user) {
                const userNameElement = document.querySelector('.user-name');
                if (userNameElement) {
                    userNameElement.textContent = `${user.first_name} ${user.last_name}`;
                }
            }
        }

        async function logout() {
            try {
                await window.authService.logout();
                Swal.fire({
                    title: 'Logged Out',
                    text: 'You have been successfully logged out.',
                    icon: 'success',
                    timer: 2000,
                    showConfirmButton: false
                }).then(() => {
                    window.location.href = '/login.html';
                });
            } catch (error) {
                console.error('Logout error:', error);
                window.authService.clearSession();
                window.location.href = '/login.html';
            }
        }

        function showError(message) {
            Swal.fire({
                title: 'Error',
                text: message,
                icon: 'error',
                confirmButtonText: 'OK'
            });
        }

        function setupNavigation() {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    const section = this.dataset.section;
                    document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                    document.getElementById(section + '-section').classList.add('active');
                    
                    document.getElementById('pageTitle').textContent = this.querySelector('span').textContent;
                    
                    if (section === 'timetable') {
                        initializeTeacherCalendar();
                    }
                    if (section === 'attendance') {
                        loadAttendanceList();
                    }
                });
            });
        }

        // Initialize Charts
        document.addEventListener('DOMContentLoaded', function() {
            // Performance Trend
            new Chart(document.getElementById('performanceTrendChart'), {
                type: 'line',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                    datasets: [{
                        label: 'STD 8A Average',
                        data: [82, 85, 87, 89],
                        borderColor: '#8b5cf6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'STD 7B Average',
                        data: [75, 77, 79, 80],
                        borderColor: '#059669',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom' } }
                }
            });

            // Grade Distribution
            new Chart(document.getElementById('gradeDistributionChart'), {
                type: 'doughnut',
                data: {
                    labels: ['A', 'B', 'C', 'D', 'F'],
                    datasets: [{
                        data: [25, 35, 25, 10, 5],
                        backgroundColor: ['#059669', '#10b981', '#f59e0b', '#dc2626', '#7f1d1d']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });

            // Subject Performance
            new Chart(document.getElementById('subjectPerformanceChart'), {
                type: 'bar',
                data: {
                    labels: ['STD 8A', 'STD 7B', 'STD 6B'],
                    datasets: [{
                        label: 'Class Average',
                        data: [87, 78, 88],
                        backgroundColor: ['#8b5cf6', '#059669', '#0891b2'],
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, max: 100 }
                    }
                }
            });

            // Attendance Overview
            new Chart(document.getElementById('attendanceOverviewChart'), {
                type: 'bar',
                data: {
                    labels: ['STD 8A', 'STD 7B', 'STD 6B'],
                    datasets: [{
                        label: 'Present',
                        data: [98, 94, 95],
                        backgroundColor: '#059669'
                    }, {
                        label: 'Absent',
                        data: [2, 6, 5],
                        backgroundColor: '#dc2626'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, max: 100 }
                    }
                }
            });

            // Animate progress bars
            setTimeout(() => {
                document.querySelectorAll('.progress-bar-animated').forEach(bar => {
                    bar.style.width = bar.dataset.target + '%';
                });
            }, 500);

            // Welcome message
            setTimeout(() => {
                Swal.fire({
                    title: 'Welcome Back, Mrs. Johnson! 👩‍🏫',
                    text: '12 assignments to grade | 4 new messages from parents',
                    icon: 'info',
                    timer: 3000,
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timerProgressBar: true
                });
            }, 500);
        });

        // Quick Actions
        function quickMarkAttendance() {
            document.querySelector('[data-section="attendance"]').click();
        }

        function quickCreateAssignment() {
            createNewAssignment();
        }

        function quickGradeWork() {
            document.querySelector('[data-section="grading"]').click();
        }

        function quickMessageParents() {
            composeMessage();
        }

        // View Class
        function viewClass(classId) {
            const classes = {
                1: { name: 'STD 8 - Stream A', subject: 'Mathematics', students: 28 },
                2: { name: 'STD 7 - Stream B', subject: 'Mathematics', students: 30 },
                3: { name: 'STD 6 - Stream B', subject: 'Science', students: 27 }
            };
            
            const cls = classes[classId];
            document.querySelector('[data-section="students"]').click();
            Swal.fire({
                title: cls.name,
                text: `${cls.subject} | ${cls.students} Students`,
                icon: 'info',
                toast: true,
                position: 'top-end',
                timer: 2000,
                showConfirmButton: false
            });
        }

        // View Student Details (Correlates with student portal data)
        function viewStudentDetails(studentName) {
            const students = {
                'John Smith': {
                    admNo: '2025001',
                    class: 'STD 8 - Stream A',
                    avgGrade: 'A- (92%)',
                    attendance: '98%',
                    recentScores: { math: 92, english: 85, science: 88 },
                    assignments: '15/15 submitted',
                    behavior: 'Excellent'
                },
                'Sarah Smith': {
                    admNo: '2025045',
                    class: 'STD 6 - Stream B',
                    avgGrade: 'A (95%)',
                    attendance: '95%',
                    recentScores: { science: 95, english: 92, math: 90 },
                    assignments: '12/12 submitted',
                    behavior: 'Very Good'
                }
            };
            
            const student = students[studentName];
            if (!student) return;
            
            Swal.fire({
                title: studentName,
                html: `
                    <div style="text-align: left;">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px;">
                            <div>
                                <label style="font-weight: 600; color: #64748b; font-size: 0.85rem;">Admission No:</label>
                                <p style="font-size: 1.1rem; margin-top: 5px;">${student.admNo}</p>
                            </div>
                            <div>
                                <label style="font-weight: 600; color: #64748b; font-size: 0.85rem;">Class:</label>
                                <p style="font-size: 1.1rem; margin-top: 5px;">${student.class}</p>
                            </div>
                            <div>
                                <label style="font-weight: 600; color: #64748b; font-size: 0.85rem;">Average Grade:</label>
                                <p style="font-size: 1.1rem; margin-top: 5px; color: #059669;">${student.avgGrade}</p>
                            </div>
                            <div>
                                <label style="font-weight: 600; color: #64748b; font-size: 0.85rem;">Attendance:</label>
                                <p style="font-size: 1.1rem; margin-top: 5px; color: #059669;">${student.attendance}</p>
                            </div>
                            <div>
                                <label style="font-weight: 600; color: #64748b; font-size: 0.85rem;">Assignments:</label>
                                <p style="font-size: 1.1rem; margin-top: 5px;">${student.assignments}</p>
                            </div>
                            <div>
                                <label style="font-weight: 600; color: #64748b; font-size: 0.85rem;">Behavior:</label>
                                <p style="font-size: 1.1rem; margin-top: 5px; color: #059669;">${student.behavior}</p>
                            </div>
                        </div>
                        
                        <div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <strong style="display: block; margin-bottom: 10px;">Recent Subject Scores:</strong>
                            ${Object.entries(student.recentScores).map(([subject, score]) => `
                                <div style="margin: 8px 0;">
                                    <span style="text-transform: capitalize;">${subject}:</span>
                                    <strong style="color: #8b5cf6; margin-left: 10px;">${score}%</strong>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `,
                width: 700,
                confirmButtonText: '<i class="fas fa-comment"></i> Message Parent',
                showCancelButton: true,
                cancelButtonText: 'Close',
                confirmButtonColor: '#8b5cf6'
            }).then((result) => {
                if (result.isConfirmed) {
                    composeMessage(`Parent of ${studentName}`);
                }
            });
        }

        // Create New Assignment
        function createNewAssignment() {
            Swal.fire({
                title: 'Create New Assignment',
                html: `
                    <div style="text-align: left;">
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Class</label>
                            <select class="swal2-input" id="assignmentClass">
                                <option>STD 8 - Stream A (Mathematics)</option>
                                <option>STD 7 - Stream B (Mathematics)</option>
                                <option>STD 6 - Stream B (Science)</option>
                            </select>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Title</label>
                            <input type="text" class="swal2-input" id="assignmentTitle" placeholder="e.g., Chapter 5 Exercises">
                        </div>
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Description</label>
                            <textarea class="swal2-textarea" id="assignmentDesc" placeholder="Describe the assignment..."></textarea>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Due Date</label>
                            <input type="datetime-local" class="swal2-input" id="assignmentDue">
                        </div>
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Total Marks</label>
                            <input type="number" class="swal2-input" id="assignmentMarks" placeholder="100" value="100">
                        </div>
                    </div>
                `,
                confirmButtonText: '<i class="fas fa-plus"></i> Create Assignment',
                showCancelButton: true,
                confirmButtonColor: '#8b5cf6',
                width: 650,
                preConfirm: () => {
                    const title = document.getElementById('assignmentTitle').value;
                    const desc = document.getElementById('assignmentDesc').value;
                    if (!title || !desc) {
                        Swal.showValidationMessage('Please fill all required fields');
                        return false;
                    }
                    return true;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Assignment Created! 📝',
                        text: 'Students have been notified',
                        confirmButtonColor: '#059669'
                    });
                }
            });
        }

        // Grade Submission
        function gradeSubmission(studentName, assignmentId) {
            Swal.fire({
                title: `Grade: ${studentName}`,
                html: `
                    <div style="text-align: left;">
                        <div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <strong>Assignment: Chapter 5 Exercises</strong>
                            <p style="color: #64748b; margin: 5px 0;">Submitted: Oct 3, 2025 3:45 PM</p>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Marks Obtained</label>
                            <input type="number" class="swal2-input" id="marksObtained" placeholder="Out of 100" max="100">
                        </div>
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Grade</label>
                            <select class="swal2-input" id="gradeSelect">
                                <option value="">Auto-calculate</option>
                                <option>A+ (90-100%)</option>
                                <option>A (85-89%)</option>
                                <option>A- (80-84%)</option>
                                <option>B+ (75-79%)</option>
                                <option>B (70-74%)</option>
                            </select>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Feedback</label>
                            <textarea class="swal2-textarea" id="gradeFeedback" placeholder="Provide feedback to the student..."></textarea>
                        </div>
                    </div>
                `,
                confirmButtonText: '<i class="fas fa-save"></i> Submit Grade',
                showCancelButton: true,
                confirmButtonColor: '#8b5cf6',
                width: 600,
                preConfirm: () => {
                    const marks = document.getElementById('marksObtained').value;
                    if (!marks) {
                        Swal.showValidationMessage('Please enter marks');
                        return false;
                    }
                    return true;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Grade Submitted! ✅',
                        html: 'Student and parent have been notified',
                        confirmButtonColor: '#059669'
                    });
                }
            });
        }

        // Mark Attendance
        function loadAttendanceList() {
            const students = ['John Smith', 'Sarah Smith', 'Victor Sam', 'Damaris Jaleny', 'George Bradox'];
            const tbody = document.getElementById('attendanceTableBody');
            
            tbody.innerHTML = students.map((student, i) => `
                <tr>
                    <td><strong>${student}</strong></td>
                    <td>
                        <select class="attendance-status" style="padding: 8px; border-radius: 6px; border: 1px solid var(--border);">
                            <option value="present" selected>✅ Present</option>
                            <option value="absent">❌ Absent</option>
                            <option value="late">⏰ Late</option>
                            <option value="excused">📝 Excused</option>
                        </select>
                    </td>
                    <td>
                        <input type="text" placeholder="Optional remarks..." style="padding: 8px; border-radius: 6px; border: 1px solid var(--border); width: 100%;">
                    </td>
                </tr>
            `).join('');
        }

        function markAllPresent() {
            document.querySelectorAll('.attendance-status').forEach(select => {
                select.value = 'present';
            });
            Swal.fire({
                title: 'Marked All Present! ✅',
                toast: true,
                position: 'top-end',
                icon: 'success',
                timer: 1500,
                showConfirmButton: false
            });
        }

        function submitAttendance() {
            Swal.fire({
                title: 'Submit Attendance?',
                text: 'Confirm attendance for selected class and date',
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#8b5cf6',
                confirmButtonText: 'Yes, submit'
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Attendance Submitted! ✅',
                        text: 'Students and parents have been notified',
                        confirmButtonColor: '#059669'
                    });
                }
            });
        }

        // Compose Message
        function composeMessage(recipient = '') {
            Swal.fire({
                title: 'Compose Message',
                html: `
                    <div style="text-align: left;">
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">To:</label>
                            <select class="swal2-input">
                                <option value="">Select Recipient</option>
                                <option ${recipient.includes('John') ? 'selected' : ''}>Parent of John Smith</option>
                                <option ${recipient.includes('Sarah') ? 'selected' : ''}>Parent of Sarah Smith</option>
                                <option>Parent of Victor Sam</option>
                                <option>All Parents - STD 8A</option>
                            </select>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Subject:</label>
                            <input type="text" class="swal2-input" placeholder="Message subject">
                        </div>
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Message:</label>
                            <textarea class="swal2-textarea" placeholder="Type your message..." rows="6"></textarea>
                        </div>
                    </div>
                `,
                confirmButtonText: '<i class="fas fa-paper-plane"></i> Send Message',
                showCancelButton: true,
                confirmButtonColor: '#8b5cf6',
                width: 650
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Message Sent! ✉️',
                        text: 'Your message has been delivered',
                        confirmButtonColor: '#059669'
                    });
                }
            });
        }

        // View Message
        function viewMessage(msgId) {
            Swal.fire({
                title: 'Question about Mathematics Exam',
                html: `
                    <div style="text-align: left;">
                        <div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <strong>Parent of John Smith</strong>
                            <div style="color: #64748b; font-size: 0.85rem; margin-top: 5px;">1 day ago</div>
                        </div>
                        <div style="padding: 15px; background: white; border-radius: 8px; border: 1px solid #e2e8f0;">
                            <p style="line-height: 1.6;">Dear Mrs. Johnson,</p>
                            <p style="line-height: 1.6; margin-top: 10px;">I wanted to ask about the upcoming mathematics exam. What topics will be covered?</p>
                            <p style="line-height: 1.6; margin-top: 10px;">Thank you,<br>Parent of John Smith</p>
                        </div>
                    </div>
                `,
                confirmButtonText: '<i class="fas fa-reply"></i> Reply',
                showCancelButton: true,
                cancelButtonText: 'Close',
                confirmButtonColor: '#8b5cf6',
                width: 600
            }).then((result) => {
                if (result.isConfirmed) {
                    composeMessage('Parent of John Smith');
                }
            });
        }

        // Calendar
        function initializeTeacherCalendar() {
            const calendarEl = document.getElementById('teacherCalendar');
            if (!calendarEl || calendarEl.innerHTML) return;

            const calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'timeGridWeek',
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek'
                },
                events: [
                    { title: 'STD 8A - Math', daysOfWeek: [1,3,5], startTime: '08:00', endTime: '09:00', color: '#8b5cf6' },
                    { title: 'STD 7B - Math', daysOfWeek: [2,4], startTime: '09:00', endTime: '10:00', color: '#059669' },
                    { title: 'STD 6B - Science', daysOfWeek: [1,3,5], startTime: '10:30', endTime: '11:30', color: '#0891b2' }
                ]
            });
            calendar.render();
        }

        function viewSubmissions(assignmentId) {
            Swal.fire({
                title: 'Assignment Submissions',
                html: `
                    <div style="text-align: left;">
                        <div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <strong>Chapter 5 Exercises</strong>
                            <p style="color: #64748b; margin-top: 5px;">STD 8 - Stream A | Due: Oct 5, 2025</p>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                            <div style="text-align: center; flex: 1;">
                                <div style="font-size: 2rem; font-weight: 700; color: #059669;">15</div>
                                <div style="color: #64748b;">Submitted</div>
                            </div>
                            <div style="text-align: center; flex: 1;">
                                <div style="font-size: 2rem; font-weight: 700; color: #f59e0b;">13</div>
                                <div style="color: #64748b;">Pending</div>
                            </div>
                            <div style="text-align: center; flex: 1;">
                                <div style="font-size: 2rem; font-weight: 700; color: #8b5cf6;">54%</div>
                                <div style="color: #64748b;">Submission Rate</div>
                            </div>
                        </div>
                        <strong>Submitted Students:</strong>
                        <div style="margin-top: 10px; max-height: 200px; overflow-y: auto;">
                            <div style="padding: 10px; background: white; border-radius: 6px; margin-bottom: 8px; border-left: 3px solid #059669;">
                                John Smith - Submitted Oct 3, 3:45 PM
                            </div>
                            <div style="padding: 10px; background: white; border-radius: 6px; margin-bottom: 8px; border-left: 3px solid #059669;">
                                Victor Sam - Submitted Oct 4, 10:20 AM
                            </div>
                        </div>
                    </div>
                `,
                width: 600,
                confirmButtonText: 'Close'
            });
        }

        function viewGrades(assignmentId) {
            Swal.fire({
                title: 'Assignment Grades',
                text: 'All students have been graded for this assignment',
                icon: 'success'
            });
        }

        function manageClass(classId) {
            viewClass(classId);
        }

        function filterStudents(className) {
            Swal.fire({
                title: 'Filtering...',
                text: `Showing students from ${className}`,
                icon: 'info',
                toast: true,
                position: 'top-end',
                timer: 1500,
                showConfirmButton: false
            });
        }

        function showNotifications() {
            Swal.fire({
                title: '🔔 Notifications',
                html: `
                    <div style="text-align: left;">
                        <div style="padding: 15px; background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 8px; margin-bottom: 10px;">
                            <strong>12 Assignments to Grade</strong>
                            <p style="margin: 5px 0; color: #64748b;">From STD 8A - Chapter 5 Exercises</p>
                        </div>
                        <div style="padding: 15px; background: #dbeafe; border-left: 4px solid #0891b2; border-radius: 8px; margin-bottom: 10px;">
                            <strong>New Message from Parent</strong>
                            <p style="margin: 5px 0; color: #64748b;">Parent of John Smith sent a message</p>
                        </div>
                        <div style="padding: 15px; background: #f0fdf4; border-left: 4px solid #059669; border-radius: 8px; margin-bottom: 10px;">
                            <strong>Class Average Improved!</strong>
                            <p style="margin: 5px 0; color: #64748b;">STD 8A average is now 89%</p>
                        </div>
                    </div>
                `,
                showCloseButton: true,
                showConfirmButton: false,
                width: 600
            });
        }

        function showUserMenu() {
            Swal.fire({
                title: 'Account Menu',
                html: `
                    <div style="text-align: left;">
                        <button onclick="viewProfile()" style="width: 100%; padding: 15px; background: white; border: 1px solid #e2e8f0; border-radius: 8px; margin-bottom: 10px; cursor: pointer; text-align: left;">
                            <i class="fas fa-user" style="margin-right: 10px; color: #8b5cf6;"></i> View Profile
                        </button>
                        <button onclick="changePassword()" style="width: 100%; padding: 15px; background: white; border: 1px solid #e2e8f0; border-radius: 8px; margin-bottom: 10px; cursor: pointer; text-align: left;">
                            <i class="fas fa-key" style="margin-right: 10px; color: #8b5cf6;"></i> Change Password
                        </button>
                        <button onclick="logout()" style="width: 100%; padding: 15px; background: white; border: 1px solid #e2e8f0; border-radius: 8px; cursor: pointer; text-align: left;">
                            <i class="fas fa-sign-out-alt" style="margin-right: 10px; color: #dc2626;"></i> Logout
                        </button>
                    </div>
                `,
                showConfirmButton: false,
                showCloseButton: true
            });
        }

        function viewProfile() {
            Swal.close();
            document.querySelector('[data-section="profile"]').click();
        }

        function changePassword() {
            Swal.close();
            Swal.fire({
                title: 'Change Password',
                html: `
                    <input type="password" class="swal2-input" placeholder="Current Password">
                    <input type="password" class="swal2-input" placeholder="New Password">
                    <input type="password" class="swal2-input" placeholder="Confirm Password">
                `,
                confirmButtonText: 'Change Password',
                showCancelButton: true,
                confirmButtonColor: '#8b5cf6'
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire('Success!', 'Password changed', 'success');
                }
            });
        }

        function editProfile() {
            Swal.fire({
                title: 'Edit Profile',
                html: `
                    <input type="text" class="swal2-input" placeholder="First Name" value="Mary">
                    <input type="text" class="swal2-input" placeholder="Last Name" value="Johnson">
                    <input type="email" class="swal2-input" placeholder="Email" value="m.johnson@ks.ac.ke">
                    <input type="tel" class="swal2-input" placeholder="Phone" value="+254 700 111 222">
                `,
                confirmButtonText: 'Save Changes',
                showCancelButton: true,
                confirmButtonColor: '#8b5cf6'
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire('Saved!', 'Profile updated', 'success');
                }
            });
        }

        function logout() {
            Swal.close();
            Swal.fire({
                title: 'Logout?',
                text: 'Are you sure you want to logout?',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: 'Yes, logout',
                confirmButtonColor: '#dc2626'
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = 'login.html';
                }
            });
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
        }
    </script>
</body>
</html>

